create key vault using powershell

1) create a key vault

New-AzKeyVault -VaultName 'royKeyVault' -ResourceGroupName 'student_ops' -Location 'australiaeast'

2) create a certificate policy


$policy = New-AzKeyVaultCertificatePolicy -SubjectName "CN=trstringer.com" -ValidityInMonths 1  -IssuerName Unknown

3) create the csr

$csr = Add-AzKeyVaultCertificate -VaultName royKeyVault -Name rt-Certificate -CertificatePolicy $policy
$csr.CertificateSigningRequest

$csr = Add-AzKeyVaultCertificate -VaultName royKeyVault -Name rtCertificate -CertificatePolicy $policy
$csr.CertificateSigningRequest

4) certificate signing request

MIICqTCCAZECAQAwGTEXMBUGA1UEAxMOdHJzdHJpbmdlci5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC+6CB5MVVzZMNADJ/bdJUdu+E6qqACGATVgAqnAuLHjGpH2V5pAGeUlcUSxXvfuM7rwEvAQQtEcsxht12PFJ/9ggXYnf9EF8Iy6v4V3QnO81L789yJi6l2Ec4YYBN/CK6EAmVAMrfFfoIsA6q1Lc6lp6ievoaSh2WLC4cwkfhiLcSi6rh4alysmw4/q8oL7LFgVK8XbwfswnLwIBRlO6DDHeIaP9e9y8GmFVR6Fl6Ek2Xt7YxxZwRwo3J2WVbfwf8tmN7018it+y2rqaX9JCzu348UbokSoXXls9yorobH9v9yLCRYGq5Y7H58x5oUUg7jV/TjdsznwF7Cc4cLPQ4ZAgMBAAGgSzBJBgkqhkiG9w0BCQ4xPDA6MA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwCQYDVR0TBAIwADANBgkqhkiG9w0BAQsFAAOCAQEAVuw+FG9+bC3giRyDlx2eVFqZ84/+qMB0JTG7xz1L5Z2P4cbMCV6ExH1t0mrcpd1eeLWFmtIZvJAdEr9Mq3NtnKGv+Q0Fange/x67ql3SglhdHw/GGFRAb/BpOnZDAExjRpoabq59jakFh/RtJsZSGsG962Bt06u1e33LRUy8BZJ1/jVigCeMUJSdOLnzRzsgwEsU4Hx+foiVMlUor30AgSmd70VHlScbSHLT7/ewX/+6A8vyGOwVXRyXU4srHFlPX9fkXC0/NvpXxRbXkp+HIKftrLLvdq4Ixe8dIsGRoNRFHwrChNivJDMPXDgs9QrXNGu2GXmK7A5HcO6jzf1DJg==

5) merge signed request

Import-AzKeyVaultCertificate -VaultName royKeyVault  -Name rtCertificate -FilePath C:\test\OutputCertificateFile.cer

MIICqTCCAZECAQAwGTEXMBUGA1UEAxMOdHJzdHJpbmdlci5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDqOm4YJL97fM67N0Y25UGIcSaJTQAnVFrVb0DE7+aTV8vIoEw6Bgclh1VWNei1wwRBK/g4oOOek+4+4/PG57jFjaGUPIs7v6NC+ZB2i5gDMjQ8OVHM4uoclmRjMQ16AdUTnfmFXhVceWqO21Givg4Ap/hCeEKPIFgAxC+CdJyV+EZZraO6MK9KeHAgz+guQU/wYxm3+mHp5jgGVOkeYVMpLJyHbUQEPVIsdlA+6DnU+EZyLlwiB4fmy5jjUaZY/hGHDHoxIlqZyrR0P7oTh5f78iiAsZqr4P81mYTxcymsPIFqWe7SxQQZ1wwPafQF9gd24gcYwlPM/ZB8qa8hq9HxAgMBAAGgSzBJBgkqhkiG9w0BCQ4xPDA6MA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwCQYDVR0TBAIwADANBgkqhkiG9w0BAQsFAAOCAQEAzoW6LOG809Ag4RS+IjhJP3Rx0gzwq/6/cvo9c3FGaIRXPmNh4JYEVW47RFI3qa0ET+vKG3457g40g3orT7qx0g9Sye1HsYhEO7gDYbzA/BWHgA7TwqVlWph23L4KV92PNS6XNJfa4QHLQ2Lcacr/KygN+WG7LoIo/DPuCxRpMOAksWnuMKuDaTe91yY2LFwv/TUSIYoD+F08hKFC2bOy893f0Wiao+xp3rpHOceR/26BQzC1YJNsHVglQkkAkfYazmyv+gJo6HpKOxAMOJujG62zv6peefj5hdcEebHhFZ2WPnKu2kTm2eyXcAACnYJRC64cGYIpr6is1xcSBqKdjw==